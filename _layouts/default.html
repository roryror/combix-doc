<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Example</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
    <link rel="stylesheet" href="{{ site.baseurl }}/css/main.css">
    <link rel="apple-touch-icon" href="{{ site.baseurl }}/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="{{ site.baseurl }}/touch-icon.png" sizes="192x192">
    <link rel="icon" type="image/png" href="{{ site.baseurl }}/images/favicon.png">

    {% if jekyll.environment == 'production' and site.google_analytics_key != '' %}
        <script>
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', '{{ site.google_analytics_key }}', 'auto');
            ga('send', 'pageview');
        </script>
        <script async src='https://www.google-analytics.com/analytics.js'></script>
    {% endif %}
    <style>
        body {
            display: flex;
        }
        header {
            position: fixed;
            width: 300px;
            height:720px;
        }
        nav {
            top: 0;
            left: 0;
            bottom: 0;
            width: 300px;
            height:720px;
            overflow-y: auto;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            z-index: -1000; 
        }
        .main {
            margin-left: 300px; /* width of the fixed nav + some margin */
            padding: 20px;
            flex: 1;
            height:700px;
            overflow-y: auto;
        }
        nav ul {
            width: 300px;
            list-style: none;
            padding: 0;
            margin: 0;
        }
        nav > ul > li {
            position: relative;
            border-radius: 8px;
        }
        nav ul ul {
            display: none;
            position: relative;
            top: 100%;
            left: 0;
            width: 300px;
            overflow-y: auto;
            background-color: #fff;
            padding: 0;
            margin: 0;
            overflow: hidden;
            transition: all 0.3s ease-in-out;
        }
        nav ul ul li {
            width: 300px;
        }
        nav ul ul li a {
            display: block;
            padding: 10px;
            color: #333;
            width: 300px;
            border-radius: 5px;
            text-decoration: none;
        }
        nav ul ul li a:hover {
            background-color: #f0f0f0;
        }
        nav ul li:hover > ul {
            display: block;
        }
        nav ul li.open > ul {
            display: block;
        }
    </style>
</head>

<body>
    <header>
        <h1>
            <a href="{{ site.baseurl }}/"><img src="{{ site.baseurl }}/images/emblem.svg" width="40" height="40" alt="{{ site.title }} logo"></a>
            {{ site.title }}
            <button type="button" class="open-nav" id="open-nav"></button>
        </h1>

        <form action="{{ site.baseurl }}/search/" method="get">
            <input type="text" name="q" id="search-input" placeholder="Search" autofocus>
            <input type="submit" value="Search" style="display: none;">
        </form>

        <nav {% if site.show_full_navigation %}class="full-navigation"{% endif %}>
            <ul>
                <li class="nav-item top-level {% if page.url == '/' %}current{% endif %}">
                    {% assign home = site.html_pages | where: 'url', '/' | first %}
                    <a href="{{ site.baseurl }}/">{{ home.title }}</a>
                </li>
            </ul>

            <ul>
                {% assign grouped = site.docs | group_by: 'category' %}
                {% for group in grouped %}
                    <li class="nav-item top-level {% if group.name == page.category % and group.items | where: 'url', page.url %}open{% endif %}">
                        {% assign items = group.items | sort: 'order' %}
                        <a href="{{ site.baseurl }}{{ items.first.url }}">{{ group.name }}</a>
                        <ul>
                            {% for item in items %}
                                <li class="nav-item {% if item.url == page.url %}current{% endif %}"><a href="{{ site.baseurl }}{{ item.url }}">{{ item.title }}</a></li>
                            {% endfor %}
                        </ul>
                    </li>
                {% endfor %}
            </ul>

            <ul>
                <li class="nav-item top-level {% if page.url == '/changelog/' %}current{% endif %}">
                    {% assign changelog = site.html_pages | where: 'url', '/changelog/' | first %}
                    <a href="{{ site.baseurl }}/changelog/">{{ changelog.title }}</a>
                </li>
            </ul>
        </nav>
    </header>

    <section class="main">
        <div class="page-header">
            <h2>{% if page.category %}{{ page.category }}{% else %}{{ site.title }}{% endif %}</h2>
            <h3>{{ page.title }}</h3>
        </div>
        <article class="content">
            {{ content }}
        </article>
    </section>

    <script>
        document.getElementById("open-nav").addEventListener("click", function () {
            document.body.classList.toggle("nav-open");
        });
        // 关闭当前二级菜单
        // Handle submenu visibility
        const navItems = document.querySelectorAll('nav .nav-item.top-level');
        let delayTimer; // 延迟关闭菜单的计时器
        
        navItems.forEach(item => {
            item.addEventListener('mouseover', function () {
                if (this.classList.contains('open')) {
                   
                } else {
                    this.classList.add('open'); // 打开当前菜单
                }
            });
        
            item.addEventListener('mouseout', function () {
                const self = this;
                clearTimeout(delayTimer); // 清除之前的延迟关闭计时器
                delayTimer = setTimeout(function () {
                    // 保持菜单开启状态
                    self.classList.add('open');
                }, 500); // 设置延迟时间，单位为毫秒
            });
        });
    </script>
</body>
</html>
